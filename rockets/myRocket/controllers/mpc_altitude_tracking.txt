# MPC Controller Configuration
# Model Predictive Controller for altitude tracking with breakpoint reference

# Controller type
controllerType = MPC

# Linear model parameters: x(k+1) = A*x(k) + B*u(k)
# For altitude control, state is altitude rate
A = 0.95
B = -0.08

# MPC parameters
predictionHorizon = 20        # Longer horizon for altitude control
Q = 5.0                       # State error weight
R = 0.2                       # Control effort weight

# Control constraints
outputMin = 0.0
outputMax = 1.0
controlRateLimit = 0.03       # Smooth control changes (3% max per step)

# Model adaptation disabled for altitude control
modelAdaptationRate = 0.0

# Controlled variable: altitude rate (vertical velocity)
controlledVariable = vertical_velocity

# Reference: Desired velocity changes with altitude
referenceType = breakpoint
breakpointVariable = altitude

# Breakpoints: altitude (m) vs desired velocity (m/s)
# At high altitude: fast descent (-30 m/s)
# Near target: slow descent (-5 m/s)  
# Below target: slight ascent (+2 m/s)
referenceKeys = 0, 500, 800, 1000, 1200, 1500
referenceValues = 2.0, 1.0, -2.0, -5.0, -15.0, -30.0

# Enable controller
enabled = true
